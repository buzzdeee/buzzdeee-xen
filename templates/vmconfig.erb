# This VM config is managed via Puppet

<%- if @vmostype -%>
ostype="<%= @vmostype %>"
<%- end -%>
name="<%= @vmname %>"
<% if @vmdescription -%>
description="<%= @vmdescription %>"
<%- end -%>
uuid="<%= @vmuuid %>"
memory=<%= @vmmemory %>
<% if @vmmaxmem -%>
maxmem=<%= @vmmaxmem %>
<%- end -%>
vcpus=<%= @vmvcpus %>
<% if @vmcpus -%>
cpus="<%= @vmcpus %>"
<%- end -%>
<% if @vmon_poweroff -%>
on_poweroff="<%= @vmon_poweroff %>"
<%- end -%>
<% if @vmon_reboot -%>
on_reboot="<%= @vmon_reboot %>"
<%- end -%>
<% if @vmon_crash -%>
on_crash="<%= @vmon_crash %>"
<%- end -%>
<% if @vmlocaltime -%>
localtime=<%= @vmlocaltime %>
<%- end -%>
<% if @vmkeymap -%>
keymap="<%= @vmkeymap %>"
<%- end -%>

<% if @builder == 'hvm' -%>
builder="hvm"
  <%- if @vmdevicemodel -%>
device_model="<%= @vmdevicemodel %>"
  <%- end -%>
<% if @vmkernel -%>
kernel="<%= @vmkernel %>"
<% else -%>
kernel="/usr/lib/xen/boot/hvmloader"
<% end -%>
boot="<%= @vmbootorder %>"
  <%- if @vmstdvga -%>
stdvga=<%= @vmstdvga %>
  <%- end -%>
  <%- if @vmvnc -%>
vnc=<%= @vmvnc %>
  <%- end -%>
  <%- if @vmvncunused -%>
vncunused=<%= @vmvncunused %>
  <%- end -%>
  <%- if @vmhpet -%>
hpet=<%= @vmhpet %>
  <%- end -%>
  <%- if @vmviridian -%>
viridian=<%= @vmviridian %>
  <%- end -%>
  <%- if @vmapic -%>
apic=<%= @vmapic %>
  <%- end -%>
  <%- if @vmacpi -%>
acpi=<%= @vmacpi %>
  <%- end -%>
  <%- if @vmpae -%>
pae=<%= @vmpae %>
  <%- end -%>
  <%- if @vmserial -%>
serial="<%= @vmserial %>"
  <%- end -%>
  <%- if @vmusb -%>
usb=<%= @vmusb %>
    <%- if @vmusbdevice -%>
usbdevice='<%= @vmusbdevice %>'
    <%- end -%>
  <%- end -%>
<% end -%>
<% if @builder == 'linux' -%>
builder="linux"
<% if @vmkernel -%>
kernel="<%= @vmkernel %>"
<% end -%>
  <%- if @vmbootloader -%>
bootloader="<%= @vmbootloader %>"
  <%- end -%>
  <%- if @vmbootargs -%>
bootargs="<%= @vmbootargs %>"
  <%- else -%>
bootargs=""
  <%- end -%>
  <%- if @vmextra -%>
extra="<%= @vmextra %>"
  <%- else -%>
extra=" "
  <%- end -%>
  <%- if @vmnographic -%>
nographic=<%= @vmnographic %>
  <%- end -%>
  <%- if @vmvfb -%>
vfb=['<%= @vmvfb %>']
  <%- end -%>
<% end -%>

disk=[
<% @vmdisks.each do |disk| -%>
	'<%= disk %>',
<% end -%>
	]
vif=[
<% @vmvifs.each do |vif| -%>
'<%= vif %>',
<% end -%>
	]

